---
title: GitHub Integration
description: Set up GitHub App for automated builds from push events and pull requests
banner:
  content: |
    <strong>Experimental</strong> — Webhooks are received but builds don't run yet. For contributors only.
---

import { Steps, Tabs, TabItem, Badge, Aside } from '@astrojs/starlight/components';

<Aside type="caution">
The GitHub integration can receive webhooks and store events, but **build execution is not implemented**. Setting this up will not give you working CI/CD.
</Aside>

Oore integrates with GitHub using a **GitHub App**, providing:

- Webhook events for push, pull request, and installation events
- Installation tokens for cloning private repositories
- Commit status updates for build results
- Automatic sync when the app is installed on new repositories

## Setup via Web Dashboard

The web dashboard provides a streamlined setup experience that automates the entire GitHub App creation and installation process.

### Prerequisites

Before starting, ensure:
- Your Oore server is running and accessible
- You have an `ENCRYPTION_KEY` configured (required to store credentials securely)
- You have `OORE_ADMIN_TOKEN` set in your server environment

### Automated Setup Flow

<Steps>
1. **Navigate to Settings**

   Open the web dashboard and go to **Settings > Integrations > GitHub**.

2. **Start GitHub App Creation**

   Click the "Set up GitHub App" button. Your browser will be redirected to GitHub's app creation page.

   :::tip
   The setup flow uses GitHub's App Manifest to pre-configure all required permissions and webhook settings automatically.
   :::

3. **Create the app on GitHub**

   - Review the pre-filled app configuration
   - Choose where to create the app (personal account or organization)
   - Click "Create GitHub App"
   - The browser will show a success message and redirect to the installation page

4. **Install the app**

   - Select which repositories to grant access (all or specific ones)
   - Click "Install"
   - Repositories sync automatically via webhooks

5. **Verify in the dashboard**

   Return to the Oore dashboard. The Settings page will show:
   - GitHub App name and ID
   - Connected installations
   - Synced repositories
</Steps>

That's it! Repositories sync automatically when you install the app or modify repository access.

---

## How It Works

The setup process uses GitHub's App Manifest flow:

```
Dashboard                 oored                    GitHub
 │                          │                        │
 │  Click setup             │                        │
 ├─────────────────────────▶│                        │
 │                          │ Generate manifest      │
 │  Redirect to GitHub      │                        │
 │◀─────────────────────────│                        │
 │─────────────────────────────────────────────────▶│
 │                          │                        │
 │                          │                        │ User creates app
 │                          │                        │
 │                          │◀──── Callback ─────────┤
 │                          │  Exchange code         │
 │                          │  Store credentials     │
 │                          │                        │
 │                          │  Redirect ────────────▶│ Install app
 │                          │                        │
 │                          │◀── Installation hook ──┤
 │                          │  Auto-sync repos       │
```

Once configured:
- Credentials are stored **encrypted** in the database (AES-256-GCM)
- No environment variables needed for GitHub config
- Private key, webhook secret, and app details are managed automatically
- Installation and repository changes sync via webhooks

---

## Webhook Processing

When GitHub sends webhooks:

```
GitHub                          oored                      Build
  │                               │                          │
  │  POST /webhooks/github        │                          │
  ├──────────────────────────────▶│                          │
  │                               │ 1. Verify signature      │
  │                               │ 2. Store event           │
  │                               │ 3. Queue for processing  │
  │        {"status":"ok"}        │                          │
  │◀──────────────────────────────┤                          │
  │                               │ 4. Process background    │
  │                               │ 5. Create build          │
  │                               │ 6. Execute               │
  │                               ├─────────────────────────▶│
```

### Supported Events

| Event | Trigger |
|-------|---------|
| `push` | Code pushed to any branch |
| `pull_request.opened` | New pull request |
| `pull_request.synchronize` | PR updated with new commits |
| `installation` | App installed or modified |
| `installation_repositories` | Repositories added/removed from installation |

### Automatic Sync

When you install the GitHub App or modify repository access, Oore automatically syncs:
- New installations are added to the database
- Repository lists are updated
- Removed repositories are cleaned up

### Signature Verification

GitHub signs webhooks using HMAC-SHA256. The `X-Hub-Signature-256` header contains:

```
sha256=<hex-encoded-signature>
```

Oore verifies this signature using the webhook secret stored during setup.

---

## API Reference

For programmatic access, use the REST API:

| Endpoint | Method | Description |
|----------|--------|-------------|
| `GET /api/github/status` | GET | Show current GitHub App configuration |
| `POST /api/github/setup/start` | POST | Start GitHub App creation flow |
| `GET /api/github/installations` | GET | List all installations |
| `POST /api/github/sync` | POST | Manually sync installations and repositories |
| `DELETE /api/github/credentials` | DELETE | Remove GitHub App credentials |

All endpoints require `Authorization: Bearer <OORE_ADMIN_TOKEN>` header.

---

## Manual Sync (When Needed)

In most cases, webhooks handle synchronization automatically. Manual sync is useful when:

- Recovering from server downtime
- Debugging installation issues
- Webhooks were missed

Use the dashboard's **Settings > GitHub > Sync** button, or make an API call:

```bash
curl -X POST https://your-server.com/api/github/sync \
  -H "Authorization: Bearer $OORE_ADMIN_TOKEN"
```

---

## Troubleshooting

### "ENCRYPTION_NOT_CONFIGURED" Error

The manifest flow requires an encryption key to securely store credentials.

Add to `/etc/oore/oore.env`:
```bash
ENCRYPTION_KEY=$(openssl rand -hex 32)
```

Then restart the server.

### "ALREADY_CONFIGURED" Error

A GitHub App is already configured. To replace it, go to **Settings > GitHub** and click "Remove GitHub App", then set up again.

### Webhooks Not Received

1. **Check URL accessibility**: Your server must be publicly accessible (not localhost)
2. **Check HTTPS**: GitHub requires HTTPS for webhooks
3. **Check firewall**: Ensure the port is open
4. **View deliveries**: Go to your GitHub App settings - Advanced - Recent Deliveries

### Invalid Signature Errors

1. Use the dashboard's Sync button to refresh credentials
2. Check that the webhook URL matches your server's `OORE_BASE_URL`
3. Reinstall the GitHub App if issues persist

### Installation Not Syncing

If installations don't appear after installing the app:

1. Check that webhooks are being received (server logs)
2. Use the dashboard's Sync button to force a sync
3. Verify the app has the correct webhook URL configured

---

## Complete Example

<Steps>
1. **Configure server with encryption key**

   ```bash
   echo "ENCRYPTION_KEY=$(openssl rand -hex 32)" >> /etc/oore/oore.env
   sudo oored restart
   ```

2. **Open dashboard and navigate to Settings > GitHub**

3. **Click "Set up GitHub App"**

4. **Complete app creation and installation in browser**
   - Create the app
   - Select repositories to install
   - Done!

5. **Push code to trigger a build**

   ```bash
   git push origin main
   ```

6. **View builds in dashboard**

   Navigate to **Builds** to see the triggered build.
</Steps>
